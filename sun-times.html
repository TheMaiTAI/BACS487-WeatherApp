<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Sunrise/Sunset Times</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="header text-center p-3 bg-dark text-white">
        <h1>Sunrise and Sunset Times</h1>
        <a href="https://themaitai.github.io/BACS487-WeatherApp/" class="btn btn-warning">Home</a>
    </div>

    <div class="container mt-4">
        <div class="card p-4 shadow-sm">
            <h2 class="text-center">Enter Your ZIP Code</h2>
            <form id="zipForm" class="text-center">
                <div class="mb-3">
                    <input type="text" id="zipCode" class="form-control" placeholder="Enter ZIP Code (e.g., 10001)" required>
                </div>
                <button type="submit" class="btn btn-primary">Get Times</button>
            </form>

            <div id="results" class="mt-4 text-center">
                <h4>Sunrise: <span id="sunrise"></span></h4>
                <h4>Sunset: <span id="sunset"></span></h4>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById("zipForm").addEventListener("submit", function(event) {
            event.preventDefault();
            
            let zip = document.getElementById("zipCode").value;
            let apiKey = "YOUR_OPENWEATHERMAP_API_KEY";  // Replace with your OpenWeatherMap API Key
            
            // Step 1: Get Latitude & Longitude from ZIP code
            fetch(`https://api.openweathermap.org/data/2.5/weather?zip=${zip},US&appid=${apiKey}`)
                .then(response => response.json())
                .then(data => {
                    let lat = data.coord.lat;
                    let lon = data.coord.lon;
                    let timezone = data.timezone;  // OpenWeatherMap provides timezone offset

                    // Step 2: Get Sunrise & Sunset from Sunrise-Sunset API
                    return fetch(`https://api.sunrise-sunset.org/json?lat=${lat}&lng=${lon}&formatted=0`);
                })
                .then(response => response.json())
                .then(data => {
                    let sunriseUTC = new Date(data.results.sunrise);
                    let sunsetUTC = new Date(data.results.sunset);
                    
                    // Convert times to local timezone
                    let sunriseLocal = sunriseUTC.toLocaleTimeString("en-US", { timeZone: "America/New_York" }); 
                    let sunsetLocal = sunsetUTC.toLocaleTimeString("en-US", { timeZone: "America/New_York" });

                    // Display the results
                    document.getElementById("sunrise").innerText = sunriseLocal;
                    document.getElementById("sunset").innerText = sunsetLocal;
                })
                .catch(error => console.error("Error fetching data:", error));
        });
    </script>
</body>
</html>

